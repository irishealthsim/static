(function(n){n.fn.reportsConfig=function(t){function w(){var s={},u={},f=n("#"+i.charts).getGridData(),h,o;return t.oper==="edit"?(n.each(e,function(n){idx=this.id;f[idx]!=null?(u={},u[r.id]=idx,u.Type=f[idx].Type,u.Heading=f[idx].Heading,u.Owner=f[idx].Owner,u.Location=f[idx].Location,u.Function=f[idx].Function,u.Department=f[idx].Department,u.opstatus="edit",s[n]=u):(u={},u[r.id]=idx,u.opstatus="del",s[n]=u)}),h=n("#"+i.charts).getDataIDs(),n.each(h,function(t){idx=h[t];found=!1;n.each(e,function(){o=this.id;idx==o&&(found=!0)});found||(u={},u[r.id]=idx,u.Type=f[idx].Type,u.Heading=f[idx].Heading,u.Owner=f[idx].Owner,u.Location=f[idx].Location,u.Function=f[idx].Function,u.Department=f[idx].Department,u.opstatus="new",s[idx]=u)})):t.oper==="new"&&(o=1,n.each(f,function(){f[o]!=null&&(u={},u[r.id]=o,u.Type=f[o].Type,u.Heading=f[o].Heading,u.Owner=f[o].Owner,u.Location=f[o].Location,u.Function=f[o].Function,u.Department=f[o].Department,u.opstatus="new",s[o]=u,o++)})),s}function a(){var u=new Date,r,f;n("#"+t.baseid+i.prepday).keypress(function(){return!1});n("#"+t.baseid+i.pubday).keypress(function(){return!1});n("#"+t.baseid+i.remindday).keypress(function(){return!1});r=n("#"+t.baseid+i.pubday).val();f=n("#"+t.baseid+i.remindday).val();n("#"+t.baseid+i.prepday).datepicker({dateFormat:"M dd, yy",beforeShow:function(){if(r=n("#"+t.baseid+i.pubday).val(),r!=""){var f=new Date(r);return{minDate:u,maxDate:f}}return{minDate:u}}});n("#"+t.baseid+i.remindday).datepicker({dateFormat:"M dd, yy",beforeShow:function(){var o=n("#"+t.baseid+i.prepday).val(),e,f;if(o!=""){if(e=new Date(o),e.setDate(e.getDate()+1),f=new Date(o),r=="")switch(n("#"+t.baseid+i.frequency).val()){case"Weekly":f.setDate(f.getDate()+6);break;case"Monthly":f.setMonth(f.getMonth()+1);f.setDate(f.getDate()-1);break;case"Fortnightly":f.setDate(f.getDate()+14);break;case"Quarterly":f.setMonth(f.getMonth()+3);f.setDate(f.getDate()-1);break;case"HalfYearly":f.setMonth(f.getMonth()+6);f.setDate(f.getDate()-1)}else f=new Date(r);return{minDate:e,maxDate:f}}return{minDate:u}}});n("#"+t.baseid+i.pubday).datepicker({dateFormat:"M dd, yy",beforeShow:function(){var e=n("#"+t.baseid+i.prepday).val(),f,r;if(e!=""){f=new Date(e);f.setDate(f.getDate()+1);r=new Date(e);switch(n("#"+t.baseid+i.frequency).val()){case"Weekly":r.setDate(r.getDate()+6);break;case"Monthly":r.setMonth(r.getMonth()+1);r.setDate(r.getDate()-1);break;case"Fortnightly":r.setDate(r.getDate()+14);break;case"Quarterly":r.setMonth(r.getMonth()+3);r.setDate(r.getDate()-1);break;case"HalfYearly":r.setMonth(r.getMonth()+6);r.setDate(r.getDate()-1)}return{minDate:f,maxDate:r}}return{minDate:u}}})}function v(r){var u=!0,f,e,o,s,h,c,l,a,v,y;return n(".xp-ErrorMsg").hide(),n(".xp-ErrorMsg").removeClass("xp-ErrorMsg"),n("#"+t.baseid+i.name).val()==""&&(u=!1,f=n("#"+t.baseid+i.name+"error"),f.html("Cannot be blank"),f.addClass("xp-ErrorMsg"),f.show()),n("#"+t.baseid+i.descrip).val()==""&&(u=!1,e=n("#"+t.baseid+i.descrip+"error"),e.html("Cannot be blank"),e.addClass("xp-ErrorMsg"),e.show()),n("#"+t.baseid+i.distlist).val()==""&&(u=!1,o=n("#"+t.baseid+i.distlist+"error"),o.html("Cannot be blank"),o.addClass("xp-ErrorMsg"),o.show()),n("#"+t.baseid+i.frequency).val()==""&&(u=!1,s=n("#"+t.baseid+i.frequency+"error"),s.html("Cannot be blank"),s.addClass("xp-ErrorMsg"),s.show()),n("#"+t.baseid+i.owner).val()==""&&(u=!1,h=n("#"+t.baseid+i.owner+"error"),h.html("Cannot be blank"),h.addClass("xp-ErrorMsg"),h.show()),n("#"+t.baseid+i.pubday).val()==""&&(u=!1,c=n("#"+t.baseid+i.pubday+"error"),c.html("Cannot be blank"),c.addClass("xp-ErrorMsg"),c.show()),n("#"+t.baseid+i.prepday).val()==""&&(u=!1,l=n("#"+t.baseid+i.prepday+"error"),l.html("Cannot be blank"),l.addClass("xp-ErrorMsg"),l.show()),n("#"+t.baseid+i.remindday).val()==""&&(u=!1,a=n("#"+t.baseid+i.remindday+"error"),a.html("Cannot be blank"),a.addClass("xp-ErrorMsg"),a.show()),v=0,n.each(r,function(){v=v+1}),v==0&&(u=!1,y=n("#"+t.baseid+i.charts+"error"),y.html("Cannot be blank"),y.addClass("xp-ErrorMsg"),y.show()),u}function b(){var r={};return r[i.name]=n("#"+t.baseid+i.name).val(),r[i.descrip]=n("#"+t.baseid+i.descrip).val(),r[i.distlist]=n("#"+t.baseid+i.distlist).val(),r[i.frequency]=n("#"+t.baseid+i.frequency).val(),r[i.owner]=n("#"+t.baseid+i.owner).val(),r[i.pubday]=n("#"+t.baseid+i.pubday).val(),r[i.prepday]=n("#"+t.baseid+i.prepday).val(),r[i.remindday]=n("#"+t.baseid+i.remindday).val(),r}function k(){$basecontainer.length===0&&($basecontainer=n("<div id='"+t.baseid+"' class='"+l.OuterPanel+"' style='width:75%'>"),s=n("<div class='xp-MainHeader'><table width='100%' class='ui-widget-header ui-corner-all'><tr><td style='padding:4px'><div class='ui-widget-header'><div  class='xp-FloatLeft;'><img src='/_layouts/images/XPointBase/reports.png'/><\/div><div class='xp-FloatLeft;' style='padding:3px;'>Reports Configuration<\/div><\/div><\/td><\/tr><\/table><\/div>"),$basecontainer.append(s),o=n("<div class='xp-MainContent'/>"),u=n("<table border='0' cellspacing='0' cellpadding='15' width='100%' id='"+t.baseid+"table'>"),$tr=n("<tr/>"),$tr.append(n("<td style='width:5%' class='xp-FontBold'>").append(r.name).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),$tr.append(n("<td colspan='5' style='' id='"+t.baseid+i.name+"td'>").append("<input type='text'  autocomplete='off' class='xp-TxtBox xp-Width60' id='"+t.baseid+i.name+"'/><div id='"+t.baseid+i.name+"error' class='xp-FloatLeft xp-Width60' style='display:none;'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='' class='xp-FontBold'>").append(r.owner).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),$tr.append(n("<td colspan='5'  id='"+t.baseid+i.owner+"td'>").append("<input class='reportpeople' autocomplete='off' type='text' id='"+t.baseid+i.owner+"'/><div id='"+t.baseid+i.owner+"error' class='xp-FloatLeft' style='display:none;width:25%;'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='vertical-align:top' class='xp-FontBold'>").append(r.descrip).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),$tr.append(n("<td colspan='5'  id='"+t.baseid+i.descrip+"td'>").append("<textarea class='xp-ReportsMultiText' id='"+t.baseid+i.descrip+"'/><div id='"+t.baseid+i.descrip+"error' class='xp-FloatLeft xp-Width70' style='display:none;'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='vertical-align:top' class='xp-FontBold'>").append(r.frequency).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),fieldhtml="<select id='"+t.baseid+i.frequency+"' style='reportddl' >",n.each(p,function(){fieldhtml+="<option value='"+this.value+"'>"+this.name+"<\/option>"}),fieldhtml+="<\/select><div id='"+t.baseid+i.frequency+"error' style='display:none'/>",$tr.append(n("<td colspan='5' id='"+t.baseid+i.frequency+"td'>").append(fieldhtml)),u.append($tr),$tr=n("<tr>"),$tr.append(n("<td style='vertical-align:top;' class='xp-FontBold'>").append(r.prepday).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),$tr.append(n("<td width='15%' id='"+t.baseid+i.prepday+"td'>").append("<input type='text' autocomplete='off' class='reportdatepick' id='"+t.baseid+i.prepday+"'/><div id='"+t.baseid+i.prepday+"error' style='display:none'/>")),u.append($tr),$tr.append(n("<td width='10%' class='xp-FontBold' style='white-space:nowrap;'>").append(r.remindday).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),$tr.append(n("<td width='15%' id='"+t.baseid+i.remindday+"td'>").append("<input class='reportdatepick' autocomplete='off' autocomplete='off' type='text' id='"+t.baseid+i.remindday+"'/><div id='"+t.baseid+i.remindday+"error' style='display:none'/>")),u.append($tr),$tr.append(n("<td width='10%' class='xp-FontBold' style='white-space:nowrap;'>").append(r.pubday).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),$tr.append(n("<td width='15%' id='"+t.baseid+i.pubday+"td'>").append("<input class='reportdatepick' autocomplete='off' type='text' id='"+t.baseid+i.pubday+"'/><div id='"+t.baseid+i.pubday+"error' style='display:none'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='vertical-align:top; width:12%; white-space:nowrap;' class='xp-FontBold'>").append(r.charts).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),fieldhtml="<table id='"+i.charts+"' class='scroll' cellpadding='0' cellspacing='0'><\/table>",fieldhtml+="<div id='"+i.charts+"pager' class='scroll' style='text-align:center;'><\/div><div id='"+t.baseid+i.charts+"error' class='xp-FloatLeft xp-Width80' style='display:none;'/>",$tr.append(n("<td colspan='6' style='' id='"+t.baseid+i.charts+"td'/>").append(fieldhtml)),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='vertical-align:top' class='xp-FontBold'>").append(r.distlist).append("<span class='xp-Error'>"+r.asterix+"<\/span>")),$tr.append(n("<td colspan='6' id='"+t.baseid+i.distlist+"td' >").append("<textarea class='reportmultipeople' id='"+t.baseid+i.distlist+"'/><div id='"+t.baseid+i.distlist+"error' class='xp-FloatLeft xp-Width70' style='display:none;'/>")),u.append($tr),$tr=n("<tr/>"),$div=n("<div class='xp-Width50' style='margin:auto;'/>"),h=n("<input autocomplete='off' id='"+i.save+"' type='button' value='"+r.save+"' class='ui-button ui-corner-all'/>"),$savediv=n("<div class='xp-FloatLeft' style='padding:4px'/>"),$savediv.append(h),c=n("<input autocomplete='off' id='"+i.cancel+"' type='button' value='"+r.cancel+"' class='ui-button ui-corner-all'/>"),$canceldiv=n("<div class='xp-FloatLeft' style='padding:4px'/>"),c.click(function(){self.close()}),$canceldiv.append(c),$div.append($savediv),$div.append($canceldiv),$tr.append(n("<td colspan='6' />").append($div)),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td colspan='6' class='xp-Error'> * indicates mandatory fields <\/td>")),u.append($tr),o.append(u),$basecontainer.append(o),n("#"+t.container).append($basecontainer),h.click(function(){var i;gpost={};gpost.formdata=b();gpost.chartsdata=w();gpost.configid=t.configid;t.oper==="edit"?(i=v(gpost.chartsdata),i&&n.ajax({url:t.editurl,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:n.toJSON(gpost),success:function(n){var t=n.d;t=="success"?(alert("Configuration is Successfully Updated"),setTimeout(function(){self.close()},2500)):alert(t)},error:function(){}})):t.oper==="new"&&(i=v(gpost.chartsdata),i&&n.ajax({url:t.addurl,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:n.toJSON(gpost),success:function(n){var t=n.d;t=="success"?(alert("Configuration is Successfully Added"),setTimeout(function(){self.close()},2500)):alert(t)},error:function(){}}))}),a(),n(".reportpeople").peoplepicker(),n(".reportmultipeople").peoplepicker({multivalued:!0}),n("#"+i.charts).jqGrid({datatype:"local",colNames:["Chart Type","Chart Heading","Chart Owner","Location","Function","Department"],colModel:[{name:"Type",width:100,search:!1,edittype:"select",editoptions:{value:"Ideas By Status:Ideas By Status;Ideas By Type:Ideas By Type;Ideas By Owner:Ideas By Owner;Ideas By Region:Ideas By Region;Ideas By Health:Ideas By Health;Ideas By Phase:Ideas By Phase"},editable:!0},{name:"Heading",width:100,search:!1,editable:!0},{name:"Owner",width:100,search:!1,edittype:"singleperson",editable:!0},{name:"Location",width:100,search:!1,edittype:"location",editable:!0},{name:"Function",width:100,search:!1,edittype:"function",editable:!0},{name:"Department",width:100,search:!1,edittype:"department",editable:!0},],rowNum:10,rowList:[10,20,30],imgpath:"/_layouts/XPointBase/themes/xpointbasic/images",pager:jQuery("#"+i.charts+"pager"),sortname:"id",viewrecords:!0,sortorder:"desc",width:"620",height:"150"}).navGrid("#"+i.charts+"pager",{edit:!0,add:!0,del:!0,search:!1,refresh:!1}))}function d(){$basecontainer.length===0&&($basecontainer=n("<div id='"+t.baseid+"' class='"+l.OuterPanel+"'>"),s=n("<div class='xp-MainHeader'><table  class='xp-Width ui-widget-header ui-corner-all'><tr><td style='padding:4px'>Report Configuration<\/td><\/tr><\/table><\/div>"),$basecontainer.append(s),o=n("<div class='xp-MainContent'/>"),u=n("<table border='0' width='100%' id='"+t.baseid+"table'>"),$tr=n("<tr/>"),$tr.append(n("<td style='padding-left:6px;width:5%;line-height:20px;' valign='top'>").append(r.name)),$tr.append(n("<td colspan='5' class='xp-ViewLabel' id='"+t.baseid+i.name+"td'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='padding-left:6px;line-height:20px;' valign='top'/>").append(r.owner)),$tr.append(n("<td colspan='5' class='xp-ViewLabel' id='"+t.baseid+i.owner+"td'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='padding-left:6px;line-height:20px;' valign='top'/>").append(r.descrip)),$tr.append(n("<td colspan='5' class='xp-ViewLabel' id='"+t.baseid+i.descrip+"td'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='padding-left:6px;line-height:20px;' valign='top'/>").append(r.frequency)),$tr.append(n("<td colspan='5' class='xp-ViewLabel' id='"+t.baseid+i.frequency+"td'/>")),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='padding-left:6px;line-height:20px;' valign='top'/>").append(r.prepday)),$tr.append(n("<td  class='xp-ViewLabel xp-Width10' id='"+t.baseid+i.prepday+"td'/>")),u.append($tr),$tr.append(n("<td width='5%' valign='top' style='line-height:20px;'/>").append(r.remindday)),$tr.append(n("<td class='xp-ViewLabel xp-Width10' id='"+t.baseid+i.remindday+"td'/>")),u.append($tr),$tr.append(n("<td width='5%' valign='top' style='line-height:20px;'/>").append(r.pubday)),$tr.append(n("<td  class='xp-ViewLabel xp-Width10' id='"+t.baseid+i.pubday+"td'/>")),u.append($tr),$tr=n("<tr/>"),fieldhtml="<table id='"+i.charts+"'class='scroll' cellpadding='0' cellspacing='0'><\/table>",fieldhtml+="<div id='"+i.charts+"pager' class='scroll' style='text-align:center;'><\/div>",$tr.append(n("<td colspan='6' style='padding:4px 4px 4px 4px;' id='"+t.baseid+i.pubday+"td' colspan=2/>").append(fieldhtml)),u.append($tr),$tr=n("<tr/>"),$tr.append(n("<td style='padding-left:6px;line-height:20px;' valign='top'/>").append(r.distlist)),$tr.append(n("<td colspan='6' class='xp-ViewLabel' id='"+t.baseid+i.distlist+"td' />")),u.append($tr),o.append(u),$basecontainer.append(o),n("#"+t.container).append($basecontainer),a(),n(".reportpeople").peoplepicker(),n(".reportmultipeople").peoplepicker({multivalued:!0}),n("#"+i.charts).jqGrid({datatype:"local",colNames:["Chart Type","Chart Heading","Chart Owner","Location","Function","Department"],colModel:[{name:"Type",width:200,search:!1,editable:!1},{name:"Heading",width:150,search:!1,editable:!1},{name:"Owner",width:130,search:!1,edittype:"singleperson",editable:!1},{name:"Location",width:110,search:!1,edittype:"location",editable:!1},{name:"Function",width:110,search:!1,editable:!1},{name:"Department",width:110,search:!1,editable:!1},],rowNum:10,rowList:[10,20,30],imgpath:"/_layouts/Relay/GridControl/themes/customthem/images",pager:jQuery("#"+i.charts+"pager"),sortname:"id",viewrecords:!0,sortorder:"desc",caption:"Charts On Reports",width:"825",height:"100"}).navGrid("#"+i.charts+"pager",{edit:!1,add:!1,del:!1}))}function g(){n.ajax({url:t.getchartsurl,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:"{configid:'"+t.configid+"'}",success:function(t){var r=t.d;r!=null&&(e=r,e!=null&&n.each(e,function(t){var r=[];n.each(e[t].data,function(){r.Type=e[t].data.Type;r.Heading=e[t].data.Heading;r.Owner=e[t].data.Owner;r.Location=e[t].data.Location;r.Function=e[t].data.Function;r.Department=e[t].data.Department});n("#"+i.charts).addRowData(e[t].id,r);r=null}))},error:function(){}})}function nt(){n.ajax({url:t.geturl,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:"{configid:'"+t.configid+"'}",success:function(r){var u=r.d;if(u!=null&&(f=u,f!=null)){switch(t.oper){case"edit":n("#"+t.baseid+i.name).val(f[i.name]);n("#"+t.baseid+i.descrip).val(f[i.descrip]);n("#"+t.baseid+i.distlist).val(f[i.distlist]);n("#"+t.baseid+i.frequency).val(f[i.frequency]);n("#"+t.baseid+i.owner).val(f[i.owner]);n("#"+t.baseid+i.pubday).val(f[i.pubday]);n("#"+t.baseid+i.prepday).val(f[i.prepday]);n("#"+t.baseid+i.remindday).val(f[i.remindday]);break;case"read":n("#"+t.baseid+i.name+"td").append(f[i.name]);n("#"+t.baseid+i.descrip+"td").append(f[i.descrip]);n("#"+t.baseid+i.distlist+"td").append(f[i.distlist]);n("#"+t.baseid+i.frequency+"td").append(f[i.frequency]);n("#"+t.baseid+i.owner+"td").append(f[i.owner]);n("#"+t.baseid+i.pubday+"td").append(f[i.pubday]);n("#"+t.baseid+i.prepday+"td").append(f[i.prepday]);n("#"+t.baseid+i.remindday+"td").append(f[i.remindday])}tt()}},error:function(){}})}function tt(){g()}function it(){(t.oper==="edit"||t.oper==="read")&&nt()}var y={oper:"new",geturl:"",getchartsurl:"",deleteurl:"",addurl:"",suspendurl:"",editurl:"",baseid:"reportconfigbase"+n(this).attr("id"),titletext:"Create New Report",container:n(this).attr("id"),configid:-1},r={name:"Name",owner:"Owner",frequency:"Frequency",prepday:"Prepared On",remindday:"Remind On",pubday:"Publish On",charts:"Charts On Report",distlist:"Distribute To",descrip:"Description",save:"Save",cancel:"Cancel",configid:"configid",id:"id",asterix:"*"},i={name:"Title",owner:"Owner",frequency:"Frequency",prepday:"PreparationDate",remindday:"ReminderDate",pubday:"PublishingDate",charts:"ChartsOnReport",distlist:"DistributionList",descrip:"Description",save:"Save",cancel:"Cancel"},l={OuterPanel:"xp-MainDiv ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"};t=n.extend(y,t);$basecontainer=n("#"+t.baseid);var e=[],s,o,f=[],u,h,c,p=[{name:"Weekly",value:"Weekly"},{name:"Monthly",value:"Monthly"},{name:"Fortnightly",value:"Fortnightly"},{name:"Quarterly",value:"Quarterly"},{name:"HalfYearly",value:"HalfYearly"}];return this.each(function(){t.oper==="read"?d():k();(t.oper==="edit"||t.oper==="read")&&it()})}})(jQuery);
/*
//# sourceMappingURL=relay.reports.min.js.map
*/