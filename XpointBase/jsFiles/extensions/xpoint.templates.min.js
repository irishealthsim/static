(function(n){n.fn.xpointTemplates=function(t){var i,u,t,r;if(this&&this.length!=0)return(i=this,typeof t=="object")?(u=i.get(0),t=n.extend(n.xpointTemplates.defaults,t),u.options=t,n.xpointTemplates.methods.init.call(i,t)):(r=n.xpointTemplates.methods[t],r&&n.isFunction(r)?r.call(i,arguments[1]):void 0)};n.xpointTemplates={preContainers:[],templates:[],navButtons:[],component:[],contextMenuOptions:[],addNavButtons:function(t,i){n.xpointTemplates.navButtons[t]=i},addTemplate:function(t,i){n.xpointTemplates.templates[t]=i},addComponent:function(t,i){n.xpointTemplates.component[t]=i},addContextMenuOptions:function(t,i){n.xpointTemplates.contextMenuOptions[t]=i},defaults:{userId:"",destination:"",getPostsCount:10,defaultType:"Text",userReadDuration:5e3,page:1,needPage:!0,ajaxOpts:{type:"GET"},processData:function(n){return n.GetUpdatesResult},dropdownOptions:{All:"HPAllUpdates",LifeCycles:"HPLifecycle",Forum:"HPForum"},prepareUrl:function(t){return n.xpointTemplates.paths.getUpdatesServicePath+"?userId="+t.userId+"&destination="+t.destination+"&numberOfUpdates="+t.getPostsCount+"&page="+t.page+"&needPage="+t.needPage}},ids:{descriptionArea:"descriptionArea",messageContainer:"messageContainer",markAsReadContainer:"markAsReadContainer",profilePic:"profilePic",postDescriptionDiv:"postDescriptionDiv",descriptionTopDiv:"descriptionTopDiv",orgMainContainer:"orgMainContainer",orgPostDescription:"orgPostDescription",profilePicDiv:"profilePicDiv",profileUrl:"profileUrl",markAsReadDiv:"homePage_Updates_markAsReadDiv",markAsReadIcon:"markAsReadIcon",contextMenuIcon:"homePage_Updates_ContextMenuIcon",userUnSubscribe:"homePage_Updates_UserUnSubscribe",lifecycleUnSubscribe:"homePage_Updates_LifecycleUnSubscribe",forumUnSubscribe:"homePage_Updates_ForumUnSubscribe",thisPostUnSubScribe:"homePage_Updates_ThisPostUnSubscribe",descBottomUL:"descBottomUL",contextMenuDataDIV:"homePage_Updates_contextMenuDataDIV",othersContainer:"othersContainer",othersMainDiv:"othersMainDiv",othersSubDiv:"othersSubDiv",nrow:"nrow",nrowInnerDiv:"nrowInnerDiv",othersCloseMainDiv:"othersCloseMainDiv",othersCloseDiv:"othersCloseDiv",othersCloseLink:"othersCloseLink",viewMoreLink:"viewMoreLink"},classes:{container:"media",markAsReadContainer:"xp-FloatLeft xp-Width xp-BorderBottomGray xp-newHighlight",mainDiv:"xp-PositionRelative xp-FloatLeft xp-Width80 xp-Padding-6",profilePicDiv:"media-left",postDescriptionDiv:"media-body",descriptionTopDiv:"xp-Width",link:"xp-LinkLabel",descriptionBottomDiv:"xp-FloatLeft xp-Width",durationDiv:"xp-FloatLeft  xp-MarginTop-5 xp-PostionRelative",dateDiv:"xp-PositionAbsolute xp-Padding-4 ui-state-default xp-BoxShadow xp-DateHoverDiv xp-DisplayNone",markAsDiv:"xp-FloatRight xp-HoverCursor",descriptionArea:"descriptionArea xp-FloatLeft xp-Width xp-PaddingTop-4",contextMenuIcon:"homePage_Updates_ContextMenuIcon xp-FloatLeft xp-Margin-0 xp-Padding-0 xp-IconPostAction xp-Icon-Highlight",duration:"xp-FontLite xp-VerticalAlignTop xp-IconTxtAlign xp-FloatLeft",clockIcon:"xp-IconTimestamp xp-Icon xp-FloatLeft xp-PaddingRight-3",contextMenuDataDIV:"homePage_Updates_contextMenuDataDIV xp-DisplayNone xp-PositionAbsolute xp-OuterPanel xp-ClearBoth xp-FloatLeft xp-PostActionList",displayNone:"xp-DisplayNone",showDate:"xp-PositionRelative xp-Width xp-FloatLeft",messageContainer:"bs-example5 graph",markAsReadDiv:"homePage_Updates_markAsReadDiv xp-MarkRead xp-FloatLeft xp-Padding-2",markAsReadIcon:"xp-IconAddAcknowledge-Highlight xp-Icon-Highlight xp-FloatLeft xp-Padding-4",unreadMessage:"xp-NewUpdateHighlight",othersContainer:"xp-FloatLeft ui-state-default xp-LikeCommentBg xp-Width",othersMainDiv:"xp-FloatLeft xp-Width xp-LikeCommentBg",othersSubDiv:"xp-Width xp-FloatLeft xp-OthersLikeScroll",nrow:"xp-FloatLeft  xp-Width xp-LikeCommentBg",nrowInnerDiv:"xp-FloatLeft xp-Padding-4 xp-Width30",userImageDiv:"media-left",userNameDiv:"xp-FloatLeft",userName:"media-heading",othersCloseMainDiv:"xp-FloatLeft xp-CloseBox xp-Width",othersCloseDiv:"xp-FloatLeft xp-Padding-4",othersCloseLink:"xp-PaddingLeft-7 xp-LinkLabel",pollImage:"xp-Icon-Highlight  xp-IconAdminPoll"},paths:{getUpdatesServicePath:"/_vti_bin/XPointBase/UpdatesService.svc/GetUpdates",userUnSubscribe:"/_vti_bin/XPointBase/ProfileService.svc/UnFollowUser",componentUnSubscribe:"/_layouts/IImpact.Web/NotificationService.asmx/RemoveAlert",thisPostUnSubscribe:"/_vti_bin/XPointBase/UserPostsService.svc/UnfollowPost",markUpdateAsRead:"/_vti_bin/XPointBase/UpdatesService.svc/MarkUpdateAsRead",getUserDetails:"/_vti_bin/XPointBase/UpdatesService.svc/getUserDetails"},methods:{refreshData:function(t,i){if(i){var r=n("#"+n.xpointTemplates.ids.messageContainer),u=n("#"+n.xpointTemplates.ids.orgMainContainer);t.destination=i;t.page=1;r.length>0&&(r.empty(),u.length>0&&(u.addClass(n.xpointTemplates.classes.displayNone),i=="HPAllUpdates"&&u.removeClass(n.xpointTemplates.classes.displayNone)),n.xpointTemplates.methods.getData.call(r,t))}},refreshPreContainer:function(t){var i=n(".preUpdatesContainer"),r;i.length>0&&(r=i.get(0).updatesConfig,n.extend(r,t),i.empty(),n(n.xpointTemplates.preContainers).each(function(){var t=this;t&&n.isFunction(t)&&t.call(i,r)}))},init:function(){var t=this,e=t.options,r=n(t),i={},u,f;n.each(document.location.search.substr(1).split("&"),function(n,t){if(t!=""){var r=t.split("=");i[r[0].toString()]=r[1].toString()}});u=n("<div  class='preUpdatesContainer' />");f=n("<div />").attr("id",n.xpointTemplates.ids.messageContainer).attr("class",n.xpointTemplates.classes.messageContainer).appendTo(r);n("#messageContainer").load("/_layouts/XPSecuirtyAdmin/OnlineUpdates/LifecycleUpdates.aspx?TrackerID="+i.TrackerID)},ajaxCall:function(t){if(t){var i={type:"POST",contentType:"application/json; charset=utf-8",cache:!1,dataType:"json",data:""};i=n.extend(i,t);n.ajax(i)}},refreshUnRead:function(t){var i=this,r;i.unreadUpdateIds&&(r=i.unreadUpdateIds.join(","),n.xpointTemplates.methods.markRead.call(i,t,r))},markRead:function(t,i){var r={url:n.xpointTemplates.paths.markUpdateAsRead,data:'{"updateId":"'+i+'"}',success:function(){var i=n("#updatesCountDiv");i.empty();n.updatesCount.methods.refreshData.call(i,{currentUserId:t.userId})}};n.xpointTemplates.methods.ajaxCall.call(this,r)},refreshUnReadData:function(){},getBasicPostHtml:function(t,i){var r=this,u=t,o=new Date(parseInt(u.ActualTime.substr(6))),it=o.toUTCString().substr(0,o.toUTCString().lastIndexOf("UTC")),f=n("<div />").attr("class",n.xpointTemplates.classes.container).attr("style","margin-top:0px !important;").appendTo(r),e=n("<div />").attr("class",n.xpointTemplates.classes.mainDiv).appendTo(f),h,w,nt,tt;u.IsRead?f.removeClass(n.xpointTemplates.classes.unreadMessage):(r.unreadUpdateIds?r.unreadUpdateIds.push(u.UpdateID):(r.unreadUpdateIds=[],r.unreadUpdateIds.push(u.UpdateID),r.refreshRequired=!0),f.addClass(n.xpointTemplates.classes.unreadMessage),setTimeout(function(){f.removeClass(n.xpointTemplates.classes.unreadMessage)},i.userReadDuration));var v=n("<div />").attr("class",n.xpointTemplates.classes.profilePicDiv).appendTo(e),rt=n("<img width='42px'/>").attr("src",u.CreatedByPictureUrl).attr("alt","Unable to display user profile pic").appendTo(v),y=n("<div />").attr("class",n.xpointTemplates.classes.postDescriptionDiv).appendTo(e),p=n("<div />").appendTo(y),s=n("<div>"+i.msgToPrint+"<\/div>").appendTo(p);i.imageCSS&&(h=n("<div />").attr("class",n.xpointTemplates.classes.descriptionArea).appendTo(s),w=n("<div class='xp-MyPostsImg xp-FloatLeft "+i.imageCSS+"' />").appendTo(h));var c=n("<div />").attr("class",n.xpointTemplates.classes.descriptionBottomDiv).appendTo(s),l=n("<div />").attr("class",n.xpointTemplates.classes.durationDiv).appendTo(c),ut=n("<br/><hr/>").appendTo(c),ft=n("<div />").attr("class",n.xpointTemplates.classes.clockIcon).appendTo(l),b=new Date(parseInt(t.ActualTime.substr(6))),k=n.xpointTemplates.methods.formatDate(b),d=n("<div >"+n.timeago(o)+"<\/div>").attr("class",n.xpointTemplates.classes.duration).hover(function(){a.removeClass(n.xpointTemplates.classes.displayNone)},function(){a.addClass(n.xpointTemplates.classes.displayNone)}).appendTo(l),g=n("<div>").attr("class",n.xpointTemplates.classes.showDate).attr("style","height:1px").appendTo(d),a=n("<div />").attr("class",n.xpointTemplates.classes.dateDiv).attr("style","width:135px").append(k).appendTo(g);i.ExtraOptions&&i.ExtraOptions.contextMenu&&(nt=n("<div />").attr("class",n.xpointTemplates.classes.contextMenuIcon).data("item",u).data("contextMenu",i.ExtraOptions.contextMenu).appendTo(e),tt=n("<div />").attr("class",n.xpointTemplates.classes.contextMenuDataDIV).appendTo(e))},formatDate:function(n){if(typeof n=="object"){var i=n.getHours(),t=n.getMinutes(),r=t<10&&t>0?"0"+t:t,u=i>12?i-12+":"+r+" PM":i+":"+r+" AM";return n.formatDate("dd-mmm-yyyy - ")+u}return null},getOthersData:function(t){var i=n(this),r={type:"GET",cache:!1,url:n.xpointTemplates.paths.getUserDetails,data:{userMessage:t},success:function(t){var r=t.GetUserDetailsResult;n.xpointTemplates.methods.addOthersHtml.call(i,r);r.length>9?n("#"+n.xpointTemplates.ids.othersSubDiv).jScrollPane({autoReinitialise:!0,verticalDragMinHeight:"60"}):n("#"+n.xpointTemplates.ids.othersSubDiv).removeClass("xp-OthersLikeScroll")}};n.xpointTemplates.methods.ajaxCall(r)},addOthersHtml:function(t){var f=n(this),e=f.parent().parent().parent().parent(),i=n("<div />").attr("class",n.xpointTemplates.classes.othersContainer).attr("id",n.xpointTemplates.ids.othersContainer).appendTo(e),o=n("<div />").attr("class",n.xpointTemplates.classes.othersMainDiv).attr("id",n.xpointTemplates.ids.othersMainDiv).appendTo(i),s=n("<div />").attr("class",n.xpointTemplates.classes.othersSubDiv).attr("id",n.xpointTemplates.ids.othersSubDiv).appendTo(o),r=0,u;n.each(t,function(){var t=this;r%3==0&&(u=n("<div/>").attr("class",n.xpointTemplates.classes.nrow).appendTo(s));var i=n("<div />").attr("class",n.xpointTemplates.classes.nrowInnerDiv).attr("id",n.xpointTemplates.ids.nrowInnerDiv).appendTo(u),f=n("<div />").attr("class",n.xpointTemplates.classes.userImageDiv).appendTo(i),o=n("<img />").attr("src",t.UserProfilePic).appendTo(f),e=n("<div />").attr("class",n.xpointTemplates.classes.userNameDiv).appendTo(i),h=n("<a>"+t.UserName+"<\/a>").attr("class",n.xpointTemplates.classes.userName).attr("target",t.UserProfileUrl).appendTo(e);r++});var h=n("<div />").attr("class",n.xpointTemplates.classes.othersCloseMainDiv).attr("id",n.xpointTemplates.ids.othersCloseMainDiv).appendTo(i),c=n("<div />").attr("class",n.xpointTemplates.classes.othersCloseDiv).attr("id",n.xpointTemplates.ids.othersCloseDiv).appendTo(h),l=n("<a>Close<\/a>").attr("href","#").attr("class",n.xpointTemplates.classes.othersCloseLink).attr("id",n.xpointTemplates.ids.othersCloseLink).appendTo(c);n("#"+n.xpointTemplates.ids.othersCloseLink).click(function(){var t=n(this),i=t.parent().parent().parent();return i.remove(),!1})},getData:function(t){var i=this,r=n.extend({},i[0].updatesConfig,t),f=r.prepareUrl(r),u={success:function(r){if(r){var u=t.processData.call(i,r);n.xpointTemplates.methods.draw.call(i,u);i.refreshRequired&&n.xpointTemplates.methods.refreshUnRead.call(i,t)}n("."+n.xpointTemplates.ids.contextMenuIcon).click(function(){var r=n(this),i=r.next(),u,f;if(i.is(":visible"))return i.addClass("xp-DisplayNone"),!1;u=r.data().item;f=r.data().contextMenu;i.empty().removeClass("xp-DisplayNone");n(f).each(function(){var r=this,f=r.title;n.xpointTemplates.contextMenuOptions[f].add.call(i,u,t)})});n(".xp-nothers").click(function(t){var i=n(this),r=i.data().usersids,u;r&&(u=n(i).parents(".xp-PositionRelative"),n(u).has(n("#othersContainer")).length==0&&n.xpointTemplates.methods.getOthersData.call(i,r));t.preventDefault()})},url:f};u=n.extend(u,r.ajaxOpts);n.xpointTemplates.methods.ajaxCall.call(this,u)},draw:function(t){var i=this,f=0,r=n.extend({},i[0].updatesConfig),u,e;n(t.Data).each(function(){var t=this,o,s;try{r.ExtraOptions=n.parseJSON(t.ExtraOptions)}catch(h){}f=t.Count;var e=null,u=n.xpointTemplates.templates[t.FormatType]?n.xpointTemplates.templates[t.FormatType]:n.xpointTemplates.templates[r.defaultType];try{o=n.parseJSON(t.Message.replace(/\n/g,"\\n"));o&&(r.msgToPrint=o.updateMessage,e=u.jsonReader)}catch(h){r.msgToPrint=t.Message;e=u.textReader?u.textReader:null}s=u.init?u.init:n.xpointTemplates.methods.getBasicPostHtml;s.call(i,t,r);e!=null&&e.call(i,t,r)});t.NeedPage===!0&&(u=n("#"+n.xpointTemplates.ids.viewMoreLink+"_Container"),u.remove(),t.TotalCount>t.PageSize*t.Page&&(u=n("<div id='"+n.xpointTemplates.ids.viewMoreLink+"_Container' class='xp-FloatLeft xp-Width  xp-TextAlignCenter  xp-MarginTop-5' />"),u.appendTo(i),e=n("<div class=' xp-Width98 ui-secondarytabclr xp-ClearBoth ui-corner-all xp-TextAlignCenter xp-HoverCursor  ' style='margin:0 auto;' ><a id='"+n.xpointTemplates.ids.viewMoreLink+"' class='xp-PositionRelative xp-LinkLabel xp-HoverCursor xp-Height-20 xp-LineHeight-35 Tip-HPUpdatesViewMore' >View More<\/a><\/div>").appendTo(u).click(function(r){i[0].updatesConfig.page=t.Page+1;n.xpointTemplates.methods.getData.call(i,i[0].updatesConfig);r.preventDefault()})))}}};n.xpointTemplates.addTemplate("Text",{textReader:function(){},jsonReader:function(){}});n.xpointTemplates.addTemplate("Video",{jsonReader:function(){return this.each(function(){var i=n(this),r=n("."+n.xpointTemplates.ids.descriptionArea),t=n("<div class='xp-MyPostsImg xp-FloatLeft' />"),u=n("<video width='320' height='240' controls='controls'><source src='' type='video/mp4'>Your browser does not support video tag<\/video>").appendTo(t)})}});n.xpointTemplates.addTemplate("Audio",{jsonReader:function(){return this.each(function(){var i=n(this),r=n("."+n.xpointTemplates.ids.descriptionArea),t=n("<div class='xp-MyPostsImg xp-FloatLeft' />"),u=n("<audio controls='controls'><source src='' type='audio/mp3'>Your browser does not support video tag<\/audio>").appendTo(t)})}});n.xpointTemplates.addTemplate("Poll",{init:function(t,i){var r=this,u=n.extend({},i,{imageCSS:n.xpointTemplates.classes.pollImage});n.xpointTemplates.methods.getBasicPostHtml.call(r,t,u)},jsonReader:function(){return this.each(function(){var t=n(this),i=n("."+n.xpointTemplates.ids.descriptionArea)})}});n.xpointTemplates.addTemplate("Document",{jsonReader:function(){return this.each(function(){var t=n(this),i=n("."+n.xpointTemplates.ids.descriptionArea)})}});n.xpointTemplates.addComponent("c_LifeCycle",{contextMenuOptions:["user","lifecycle"],draw:function(){return this.each(function(){return n(this)})}});n.xpointTemplates.addComponent("c_UserItem",{contextMenuOptions:["user"],draw:function(){return this.each(function(){return n(this)})}});n.xpointTemplates.addComponent("c_CategoryItem",{contextMenuOptions:["user","forum"],draw:function(){return this.each(function(){return n(this)})}});n.xpointTemplates.addComponent("c_OrganizationPostItem",{contextMenuOptions:[],draw:function(){return this.each(function(){return n(this)})}});n.xpointTemplates.addComponent("c_UserPostItem",{contextMenuOptions:["user","post"],draw:function(){return this.each(function(){return n(this)})}})})(jQuery);
/*
//# sourceMappingURL=xpoint.templates.min.js.map
*/