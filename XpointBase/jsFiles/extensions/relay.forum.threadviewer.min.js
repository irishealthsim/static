var isloaded=!1;(function($){$.fn.threadViewer=function(n){function t(n,t,i,r,u,f,o,s,h,c){this.id=n;this.type=t;this.html=i;this.by=r;this.ownerpic=u;this.postdate=f;this.allowedit=o;this.allowreply=s;this.allowquote=h;this.editdate=c;this.BuildHtml=e}function r(n,t){n.RelayRichText();t&&tinymce.get(n.attr("id")).setContent(t)}function i(){tinyMCE.triggerSave()}function u(n){n.RemoveRichText()}function HighlightPost(t){var i=$("."+n.highlightcss);i.removeClass(n.highlightcss);t.addClass(n.highlightcss)}function EditMode(t,f,e,o){var l,s,h,c;$(".ps_editbtn",f).removeClass("Tip-FMEditBtn");$(".ps_editbtn",f).hide();$(".ps_replybtn",f).removeClass("Tip-FMReplyBtn");$(".ps_replybtn",f).hide();$(".ps_quotebtn",f).removeClass("Tip-FMQuoteBtn");$(".ps_quotebtn",f).hide();l=t.html();t.html("");s=$("<textarea  id='"+e.id+"_textarea' class='ps_inputtext xp-PstNewCommentBx'> <\/textarea>");s.append(l);t.append(s);r(s,l);h=$("<input type='button' class='xpThemeButton ps_savebtn ui-button  ui-corner-all' value='Save' />");f.append(h);h.wrap("<div class='xp-FloatLeft'/>");c=$("<input type='button' class=' cancelButton ps_cancelbtn ui-button  ui-corner-all' value='Cancel' />");f.append(c);c.wrap("<div class='xp-FloatLeft'/>");h.click(function(){i();e.html=s.val();var r={tpid:e.id,type:n.forumtype,html:s.val()},l={post:r};$.ajax({url:o,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:$.toJSON(l),success:function(n){var r=n.d,i,o,l;r.status=="success"&&(i=$($(".ps_editbtn",f).parent().get(0)),$(".ps_editbtn",f).show(),$(".ps_editbtn",f).addClass("Tip-FMEditBtn"),i.show(),r.allowreply&&(i=$($(".ps_replybtn",f).parent().get(0)),$(".ps_replybtn",f).show(),$(".ps_replybtn",f).addClass("Tip-FMReplyBtn"),i.show()),r.allowquote&&(i=$($(".ps_quotebtn",f).parent().get(0)),$(".ps_quotebtn",f).show(),$(".ps_quotebtn",f).addClass("Tip-FMQuoteBtn"),i.show()),u(s),t.html(e.html),HighlightPost(t),s.remove(),o=$(h.parent().get(0)),o.children().remove(),o.remove(),l=$(c.parent().get(0)),l.children().remove(),l.remove())},error:function(){}})});c.click(function(){var n=$($(".ps_editbtn",f).parent().get(0)),i,r;$(".ps_editbtn",f).show();$(".ps_editbtn",f).addClass("Tip-FMEditBtn");n.show();e.allowreply&&(n=$($(".ps_replybtn",f).parent().get(0)),$(".ps_replybtn",f).show(),$(".ps_replybtn",f).addClass("Tip-FMReplyBtn"),n.show());e.allowquote&&(n=$($(".ps_quotebtn",f).parent().get(0)),$(".ps_quotebtn",f).show(),$(".ps_quotebtn",f).addClass("Tip-FMQuoteBtn"),n.show());u(s);e.html=l;t.html(l);s.remove();i=$(h.parent().get(0));i.children().remove();i.remove();r=$(c.parent().get(0));r.children().remove();r.remove()})}function e(url,highlightdiv){var post,div,rightdiv,notch,detailsDiv,lefthtml,inputdiv,addhighlightdiv,btndiv,editbtn,replybtn,allowbtn,lastdiv;with(this)return post=this,id>0?(div=$("<div id='"+baseid+"postdiv_"+id+"' class='xp-Width xp-PstSection'/>"),lefthtml="<div class='xp-PstProfileBx xp-FontLite '><div class='xp-PstProfileBxHd xp-PstProfilePadding xp-FloatLeft'><div style='vertical-align: top;' class=' xp-FloatLeft xp-PstProfilePic'><img src='"+ownerpic+"'/><\/div><\/div>",div.append(lefthtml),rightdiv=$("<div class='xp-PstText ui-widget xp-BodyLink xp-OuterPanel ui-corner-all '/>"),notch=$("<div class='notch'><\/div><div class='notch2'><\/div>"),rightdiv.append(notch),detailsDiv=$("<div class='xp-Width xp-FloatLeft xp-FontNormal xp-MarginBottom-10'>"),editdate.length>0&&editdate!=postdate?(lefthtml="<div class=' xp-FloatLeft xp-Width40 xp-FontBold xp-FontSize11pt xp-padding-4'>"+by+"<\/div><div class=' xp-FloatRight xp-Width50 xp-FontLite xp-Padding-4'><div style='text-align:right' class=' xp-FloatRight xp-Width xp-FontSize8pt'>"+postdate+"<\/div><div style='text-align:right' class=' xp-FloatRight xp-Width xp-FontSize8pt'>Last Edit : "+editdate+"<\/div><\/div>",detailsDiv.append(lefthtml)):(lefthtml="<div class=' xp-FloatLeft xp-Width40 xp-FontBold xp-FontSize11pt'>"+by+"<\/div><div class=' xp-FloatRight xp-Width50 xp-FontLite  xp-Padding-4'><div  style='text-align:right'  class=' xp-FloatRight xp-Width xp-FontSize8pt'>"+postdate+"<\/div><\/div>",detailsDiv.append(lefthtml)),detailsDiv.append("<\/div>"),rightdiv.append(detailsDiv),inputdiv=$("<div class='ps_input xp-FloatLeft xp-Width' />"),addhighlightdiv=$("<div class='ps_input xp-FloatLeft xp-Width' />"),highlightdiv&&HighlightPost(addhighlightdiv),inputdiv.append(html),rightdiv.append(inputdiv),(allowedit||allowreply||allowquote)&&(btndiv=$("<div id='"+baseid+"_btncontainer' class='xp-PstSpacer '>"),allowedit&&(editbtn=$("<input type='button' class='xpThemeButton ps_editbtn ui-button  ui-corner-all Tip-FMEditBtn' value='edit'>"),btndiv.append(editbtn),editbtn.wrap("<div class='xp-FloatLeft'/>"),editbtn.click(function(){EditMode(inputdiv,btndiv,post,url)})),allowreply&&(replybtn=$("<input type='button' class='xpThemeButton ps_replybtn ui-button  ui-corner-all Tip-FMReplyBtn' value='reply'/>"),btndiv.append(replybtn),replybtn.wrap("<div class='xp-FloatLeft' style='padding-left:8px'/>"),replybtn.click(function(){var addinput=$("#"+ids.addinputid),tiny;addinput.attr("tpid",id);tiny=tinymce.get(ids.addinputid);tiny.setContent("");$("html, body").stop().animate({scrollTop:6e5},"slow");tiny.focus()})),allowquote&&(allowbtn=$("<input type='button' class='xpThemeButton ps_quotebtn ui-button  ui-corner-all Tip-FMQuoteBtn' value='quote'/>"),btndiv.append(allowbtn),allowbtn.wrap("<div class='xp-FloatLeft' style='padding-left:8px'/>"),allowbtn.click(function(){var addinput=$("#"+ids.addinputid),tiny,htmlcontent;addinput.attr("tpid",id);tiny=tinymce.get(ids.addinputid);tiny.setContent("");htmlcontent='<div class="xp-BgForumQuote" style="width:98%;word-wrap:break-word;display:block;padding:5px;">"'+html.replace("<p>","").replace("<\/p>"," ")+'"<\/div><br/><br/>';$.browser.msie?tiny.execCommand("mceInsertRawHTML",!1,htmlcontent):tiny.selection.setContent(htmlcontent);$("html, body").stop().animate({scrollTop:6e5},"slow");tiny.focus()})),addhighlightdiv.append(inputdiv),addhighlightdiv.append(btndiv),rightdiv.append(addhighlightdiv)),div.append(rightdiv),lastdiv=$("<div class='xp-FloatRight' style='width:1%;background-color:transparent;padding-top:15px;height:20px;'/>"),div.append(lastdiv),div.append("<div class='xp-FloatLeft xp-Width' style='height:14px;' />"),div):""}function o(i){var r={tpid:n.topicid,type:n.forumtype},u={post:r};$.ajax({url:n.topicurl,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:$.toJSON(u),success:function(r){var u=r.d;u.status=="success"&&($("#"+ids.titleContainer).append(u.title),pt=new t(u.id,u.type,u.html,u.by,u.ownerpic,u.postdate,u.allowedit,u.allowreply,u.allowquote,u.editdate),i.append(pt.BuildHtml(n.edittopicurl,!1)))},error:function(){}})}function f(i){var r={tpid:n.topicid,type:n.forumtype,page:n.page,pagesize:n.pagesize},u={post:r};$.ajax({url:n.posturl,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:$.toJSON(u),success:function(r){var e=r.d,u;$(e).length==0&&$("#commentsheadertext").html("");n.page=e.page;n.totalpages=e.totalpages;u=e.data;$.each(u,function(r){u[r].status=="success"&&(pt=new t(u[r].id,u[r].type,u[r].html,u[r].by,u[r].ownerpic,u[r].postdate,u[r].allowedit,u[r].allowreply,u[r].allowquote,u[r].editdate),i.append(pt.BuildHtml(n.editposturl,!1)))});parseInt(n.totalpages)>parseInt(n.page)&&(n.page=parseInt(n.page)+1,f(i))},error:function(){}})}function s(){$(".deletetopic").confirm({confirmmessage:"Are you sure you want to delete this forum discussion?",classname:"deletetopic"})}var n=$.extend({topicid:-1,forumtype:"",topicurl:"",posturl:"",addurl:"",editposturl:"",edittopicurl:"",highlightcss:"xp-PstNew",enableadd:!0,deletetopicurl:"",page:1,totalpages:0,pagesize:10},n),baseid=$(this).attr("id"),ids={topicheader:baseid+"_topictext",adddivid:baseid+"_addDiv",addinputid:baseid+"_addDivTextInput",topiccontainerid:baseid+"_TopicContainer",addbuttonid:baseid+"_addbuttonid",commentscontainerid:baseid+"_CommentsContainer",pagerDivId:baseid+"_pagerContainer",errorDivId:baseid+"_errorContainer",titleContainer:baseid+"_titleContainer"};return this.each(function(){var u,a,p,w,l,h,b,e,v,y,c;isloaded||(isloaded=!0,u=$(this),u.html(""),u.attr("class","xp-Width xp-FloatLeft xp-MarginTop-10"),a=$("<div id='"+ids.topicheader+"' class='xp-DivHeader ui-state-default xp-PstMnTopic xp-FloatLeft '  />"),a.append("<span id='"+ids.titleContainer+"' class='Tip-FMTopicItemHead xp-FloatLeft'><\/span>"),u.append(a),n.deletetopicurl!=""&&(p="<div class='xp-FloatRight' style='padding-right:4px;'>",p+="<a href='"+n.deletetopicurl+"' class='xpThemeButton deletetopic Tip-FMDeletBtn ui-tabbuttonstyle xp-TabLink' style='font-weight:normal!important;color:#fff !important;'>delete<\/a><\/div>",a.append(p),s()),u.append("<\/div>"),w=$("<div id='"+ids.topiccontainerid+"' class='xp-Width' />"),u.append(w),o(w),l=$("<div id='"+ids.commentscontainerid+"' class='xp-ClearBoth' />"),l.append("<div class='xp-PstTopic ui-state-default xp-DivHeader ui-widget' style='float:none;line-height:15px;font-weight:bold'><span id='commentsheadertext'>Comments<\/span><\/div>"),u.append(l),f(l),u.append("<div id='"+ids.pagerDivId+"'/>"),n.enableadd&&(h=$("<div id='"+ids.adddivid+"' class='xp-ClearBoth' style='margin-top:20px'/>"),u.append(h),b=$("<div class='xp-ErrorMsg' id='"+ids.errorDivId+"'>This topic is currently unavailable or permanently removed<\/div>").appendTo(h),b.hide(),h.append("<div class='xp-PstTopic Tip-FMAddNewCmnt' style='float:none;line-height:15px;font-weight:bold;color:#202020'>Add New Comment<\/div>"),e=$("<textarea maxlength='50' id='"+ids.addinputid+"' class='xp-PstNewCommentBx xp-PstProfilePadding' ><\/textarea>"),h.append(e),r(e),v=$("<div class='xp-FloatLeft xp-Width55' style='margin:auto;' />"),y=$("<input type='button'  value='Cancel' class='ui-button ui-secondarytabclr  ui-corner-all'/>"),v.append(y),y.wrap("<div class='xp-FloatRight xp-Padding-10'/> "),h.append(v),h.append("<br/><br/><br/>"),y.click(function(){e.val("");tinymce.get(e.attr("id")).setContent("")}),c=$("<input type='button' value='Add' id='"+ids.addbuttonid+"' tpid='-1' class='ui-button ui-primarytabclr ui-corner-all'/>"),v.append(c),c.wrap("<div class='xp-FloatRight xp-Padding-10'/> "),c.click(function(){var r,u,f;i();r=e.val();$.trim(r).length>0&&(c.attr("disabled","disabled"),$.relayloading("show"),u={tpid:n.topicid,type:n.forumtype,html:e.val()},f={post:u},$.ajax({url:n.addurl,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:$.toJSON(f),success:function(r){var u=r.d;u.status=="success"?(e.val(""),i(),pt=new t(u.id,u.type,u.html,u.by,u.ownerpic,u.postdate,u.allowedit,u.allowreply,u.allowquote,u.editdate),$("#commentsheadertext").html("Comments"),l.append(pt.BuildHtml(n.editposturl,!0)),tinymce.get(e.attr("id")).setContent("")):b.show();$.relayloading("hide");c.removeAttr("disabled")},error:function(){$.relayloading("hide");c.removeAttr("disabled")}}))})))})}})(jQuery);
/*
//# sourceMappingURL=relay.forum.threadviewer.min.js.map
*/