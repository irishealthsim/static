(function(n){n.documentLinksDialog=n.documentLinksDialog||{};n.fn.documentLinksDialog=function(t){this.options=n.extend(n.documentLinksDialog.defaults,t);n.documentLinksDialog.methods.init.apply(this,n.makeArray(this.options))};n.documentLinksDialog={defaults:{formId:""},paths:{getRootFolderContents:"/_layouts/IImpact.Web/LifeCycleService.asmx/GetRootFolderContents",getFolderContents:"/_layouts/IImpact.Web/LifeCycleService.asmx/GetFolderContents"},ids:{linkDialog:"documentLinkDialogId",buttonAttach:"buttonAttachId",buttonCancel:"buttonCancelId"},classes:{highlight:"xp-Customhighlight",lcFolder:"xp-LCDocFolder",lcFile:"xp-LCDocFile",linkRoot:"xp-LinkRoot",customTitle:"xp-CustomTitle"},methods:{init:function(t){var i=n(this);n.documentLinksDialog.methods.createHtml.apply(i,n.makeArray(t))},createHtml:function(t){var i=n(this),u=n("#"+t.formId),s=u.css("z-index"),f,r,e,o;i.hide();f=n("<div />");r=n("<div class='xp-FloatLeft xp-Width50 xp-Height-15' style='border: 1px solid #b9b9b9; padding:2px; overflow:auto;' />");r.html(i.val());e=n("<div class='xp-FloatLeft xp-Width12 xp-BoxShadow xp-HoverCursor xp-MarginLeft-12'><span class='xp-Icon xp-IconAttachPin xp-DisplayBlock xp-FloatLeft'><\/span><a class='xp-FloatLeft' style='padding:2px 4px'>Link<\/a><\/div>");o=n("<div class='xp-FloatLeft xp-Width12 xp-BoxShadow xp-HoverCursor xp-MarginLeft-12'><a class='xp-FloatLeft' style='padding:2px 4px'>Remove<\/a><\/div>");f.append(r).append(e).append(o);i.after(f);o.click(function(){r.html("");i.val("")});e.click(function(){var t=n("<div id='"+n.documentLinksDialog.ids.linkDialog+"' title=''/>");t.dialog("close");n.ajax({url:n.documentLinksDialog.paths.getRootFolderContents,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:"{}",success:function(o){var l=o.d,c=n("<div />"),h="";h+="<div class='xp-FloatLeft xp-Width'>";n.each(l,function(){h+=this});h+="<\/div>";c.append(h);t.append(c);f.append(t);t.css("z-index","999999");n("div."+n.documentLinksDialog.classes.lcFolder+" a").live("click",function(i){i.preventDefault();var r=n(this).html(),u=n(this).data().nodeid;n.ajax({url:n.documentLinksDialog.paths.getFolderContents,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:"{nodeId:"+u+"}",success:function(i){var f=i.d,u;h="";h+="<div class='xp-FloatLeft xp-Width'>";n.each(f,function(){h+=this});h+="<\/div>";c.html(h);u=n("<div class='xp-FontBold'><a class='"+n.documentLinksDialog.classes.linkRoot+"' href='#'><u>Root<\/u><\/a><span> >> "+r+" <\/span><\/div>");n("."+n.documentLinksDialog.classes.customTitle).html(u);n("a."+n.documentLinksDialog.classes.linkRoot).click(function(n){n.preventDefault();t.dialog("close");e.trigger("click")})}})});t.dialog({autoOpen:!1,width:400,height:200,modal:!0,position:{my:"center",at:"center",of:u},open:function(){var t=n(this).parent(),i;u.css("z-index","1");t.find(".ui-dialog-titlebar").removeClass("ui-widget-header").addClass("xp-BorderBottom");i=n("<div class='"+n.documentLinksDialog.classes.customTitle+" xp-FontBold xp-FloatLeft'>Root<\/div>");t.find(".ui-dialog-title").append(i);n("#"+n.documentLinksDialog.ids.buttonAttach).attr("disabled",!0);n("#"+n.documentLinksDialog.ids.buttonAttach).addClass("ui-state-disabled")},beforeclose:function(){u.css("z-index",s)},close:function(){n("div.ui-dialog").remove();n(this).dialog("destroy").dialog("widget").remove()},buttons:[{text:"Attach",id:n.documentLinksDialog.ids.buttonAttach,"class":"xpThemeButton",click:function(){var f=n("div."+n.documentLinksDialog.classes.highlight+" a"),t=n(f).data().docname,u=i.val(),o,e;i.val()==""?u="<a data-docname='"+t+"' href='"+f.attr("href")+"'>"+t+"<\/a>":(o=i.val().split(","),e=[],n.each(o,function(t,i){e.push(n(i).data().docname)}),n.inArray(t,e)==-1&&(u=u+",<a data-docname='"+t+"' href='"+f.attr("href")+"'>"+t+"<\/a>"));r.html(u);i.val(u);n(this).dialog("close")}},{text:"Cancel","class":"cancelButton",id:n.documentLinksDialog.ids.buttonCancel,click:function(){n(this).dialog("close")}}]});t.dialog("open")}});n("."+n.documentLinksDialog.classes.lcFile).live("click",function(t){t.preventDefault();n("."+n.documentLinksDialog.classes.lcFile).removeClass(n.documentLinksDialog.classes.highlight);n(this).addClass(n.documentLinksDialog.classes.highlight);n("#"+n.documentLinksDialog.ids.buttonAttach).attr("disabled",!1);n("#"+n.documentLinksDialog.ids.buttonAttach).removeClass("ui-state-disabled")})})}}}})(jQuery);
/*
//# sourceMappingURL=xpoint.documentLinksDialog.min.js.map
*/