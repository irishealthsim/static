(function(n){n.lcViews={ids:{viewName:"viewName",lcFiltersName:"lcFilterCheckBox",filterBase:"filterBase",selectBox:"selectColumnBox",saveBtn:"saveBtn",deleteBtn:"deleteBtn",errorDiv:"errorDiv",confirmDialog:"configDialog"},operands:[],methods:{getUrl:function(t,i){var u=location.href,f=u.split("?"),r=f[0];return(t&&n.trim(t).length>0&&(r+=t),i===!0)?(window.location=r,!1):r},interSection:function(t,i){return n(t).filter(function(r){var u=t[r].iName,f=n(i).filter(function(n){return i[n].iName==u});return f.length>0})},ajaxCall:function(t){n.lcViews.methods.hideError();n.ajax(n.extend({contentType:"application/json; charset=utf-8",type:"post",dataType:"json"},t))},init:function(t){var r=n(this),u,i,f,e,a,o,s,c,h;r.empty();u=n("<div  />").appendTo(r);t.events.onHeaderCreation&&n.isFunction(t.events.onHeaderCreation)&&t.events.onHeaderCreation.apply(u,n.makeArray(t));i=n("<div />").append("<div id='"+n.lcViews.ids.errorDiv+"' class='xp-DisplayNone'/>");r.xpointbox({headerContainer:u,contentContainer:i,containerStyle:"xp-FloatLeft ui-widget-content ",contentStyle:"xp-MainContent  viewContent ui-corner-all xp-OuterPanel xp-Overflowhidden",headerStyle:" xp-Padding-4 xp-DivHeader viewHeader "});f=n("<div  class='xp-Width xp-FloatLeft xp-Padding-10 ' />").append("<div  class='xp-FontBold xp-FloatLeft xp-Width12 Tip-MFViewName'>View Name<span class='xp-ErrorMessage'>*<\/span> <\/div>").append("<div  class='xp-FloatLeft xp-Width55'><input id='"+n.lcViews.ids.viewName+"' value=\""+t.viewConfig.dName+"\" class='xp-TxtBox xp-FontNormal xp-Padding-4 xp-Width30'><\/div>").appendTo(i);n("#"+n.lcViews.ids.viewName).keypress(function(n){n.which<32||this.value.length=="20"&&n.preventDefault()});t.deleteEnable===!0&&(e=n("<div  style='' />").appendTo(f),a=n("<input type='button' value='Delete view' class='ui-primarytabclr xp-HoverCursor ui-corner-all' />").appendTo(e).click(function(){n.lcViews.methods.deleteView(t)}));o=n("<div  class='xp-Width xp-FloatLeft xp-Padding-10' />").append("<div style='height:30px;' class='xp-FloatLeft xp-FontBold Tip-MFSelectLCs'>Select Lifecycles <\/div>").appendTo(i);s=n("<div class='xp-FloatLeft xp-Width98'>").appendTo(o);n.each(t.lcData,function(i){var r=t.lcData[i],u=!1,f,e;r&&(f=n("<div class='xp-FloatLeft xp-CustomForm' style='width:32.5%;margin:10px 0px 15px 0px;white-space:nowrap;'/>").appendTo(s),e=n("<input type='checkbox'  name=\""+n.lcViews.ids.lcFiltersName+'" value="'+r.iName+"\" style='padding-left:0px;' id='"+r.dName+"' ><\/input><label for='"+r.dName+"'>"+r.dName+"<\/label>").appendTo(f).click(function(){n.lcViews.methods.resetSelectedList(t);n.lcViews.methods.prepareViewColumns(t)}),t.viewConfig.lcFilter.length>0&&(u=n.inArray(r.iName,t.viewConfig.lcFilter)>-1),u===!0&&e.attr("checked","checked"))});var v=n("<div class = 'xp-Width48 xp-Padding-4 xp-FloatLeft'/>").append("<div  style='height:30px;' class='xp-Width30 xp-FloatLeft xp-FontBold Tip-MFTableColumns'>Table Columns<span class='xp-ErrorMessage'>*<\/span><\/div>").appendTo(i),h=n("<div class='xp-Width80 xp-Padding-2 xp-FontBold xp-FloatLeft' />").appendTo(v),b=n("<select id='"+n.lcViews.ids.selectBox+"' multiple='multiple'  style='width:460px;height:200px' />").append("<option><\/option>").appendTo(h);n.lcViews.methods.prepareViewColumns(t,!0);c=n("<div  class='xp-FloatRight xp-PstSectionProfilePadding xp-Width50'/>").append("<div  style='height:30px;' class='xp-Width30 xp-FontBold xp-FloatLeft Tip-MFFilters'>Filters<\/div>").appendTo(i);h=n("<div  class='xp-FontLite xp-FloatLeft' style='width:98%' id='"+n.lcViews.ids.filterBase+"' />").appendTo(c);n.lcViews.methods.prepareFilterColumns();n.lcViews.methods.addFiltersFromConfig(t.viewConfig);var y=n("<div class='xp-Width xp-FloatLeft' style='padding:10px 0px;' />").appendTo(i),l=n("<div style = 'width:130px;margin:auto;'/>").appendTo(y),p=n("<div  class='xp-FloatLeft Tip-MFSaveBtnDiv'/>").appendTo(l),k=n("<input type='button'  value='Save' class='ui-primarytabclr xp-HoverCursor ui-corner-all'/>").appendTo(p).click(function(){n.lcViews.methods.saveView(t)}),w=n("<div  class='xp-FloatRight' />").appendTo(l),d=n("<input type='button'  value='Cancel' class='ui-secondarytabclr xp-HoverCursor ui-corner-all'/>").appendTo(w).click(function(){var i="";t.viewConfig.id!=-1&&(i="?ViewId="+t.viewConfig.id);n.lcViews.methods.getUrl(i,!0)})},applySelectPlugin:function(t,i){var u=[],r=n("#"+n.lcViews.ids.selectBox).multiselect("destroy").find("option").remove().end();t&&(i&&n(i.columns).each(function(){var n=this,t;n&&(t=n.formatter?n.formatter:"text",r.append('<option value="'+n.iName+"\" formatter='"+t+"' selected=selected>"+n.dName+"<\/option>"),u[n.iName]=n.dName)}),n(t).each(function(){var n=this,t;n&&u[n.iName]==null&&(t=n.formatter?n.formatter:"text",r.append('<option value="'+n.iName+"\" formatter='"+t+"'>"+n.dName+"<\/option>"))}));r.multiselect()},showError:function(t){n("#"+n.lcViews.ids.errorDiv).html(t).addClass(n.lcViews.errorDivCss).show().fadeOut(1e4)},hideError:function(){n("#"+n.lcViews.ids.errorDiv).removeClass(n.lcViews.errorDivCss).hide()},confirmDialog:function(t,i){var r=n("#"+n.lcViews.ids.confirmDialog);r.length>0&&r.remove();r=n("<div id='"+r+"' />").hide().append(t).appendTo("body");r.dialog({resizable:!1,height:140,modal:!0,buttons:{Confirm:function(){var t=!0;i&&n.isFunction(i)&&(t=i.call());t===!0&&n(this).dialog("close")},Cancel:function(){n(this).dialog("close")}}})},deleteView:function(t){var r=t.viewConfig.id,i;t.deleteOptions.deleteData={viewId:r.toString()};i="Are you sure you want to delete current view";n.lcViews.methods.confirmDialog(i,function(){return n.lcViews.methods.ajaxCall({url:t.deleteOptions.url,data:n.toJSON(t.deleteOptions.deleteData),error:function(){n.lcViews.methods.showError("Not able to delete the view. Please try again later!")},success:function(t){var i=t.d;i.success===!0?n.lcViews.methods.getUrl(null,!0):n.lcViews.methods.showError("Not able to delete the view. Please try again later!")}}),!0})},validateViewData:function(){var t="",e=n("#"+n.lcViews.ids.viewName),i=n.trim(e.val()),r,u,f;return i.length==0?t+="<div> Please enter view Name <\/div>":(i=i.replace(" ",""),r=/[^a-zA-Z0-9 ]/g,r.test(i)===!0&&(t+="<div> Please enter valid view Name - Special characters like('!@#$%^&*()_><,.{}[]|~?/) not allowed.<\/div>")),u=n("input[name *='"+n.lcViews.ids.lcFiltersName+"']").filter(function(){var t=n(this).attr("checked");return t=="checked"||t==!0}),u==0&&(t+="<div> Please select lifecycles needed in the view <\/div>"),f=n("#"+n.lcViews.ids.selectBox).val(),f==null&&(t+="<div> Please select columns needed in the view <\/div>"),t},saveView:function(t){var f=n.lcViews.methods.validateViewData(),e,o,i,r,u,s;if(n.trim(f).length>0)return n.lcViews.methods.showError(f),!1;viewObj={};viewObj.viewId=t.viewConfig.id.toString();viewObj.viewName=n("#"+n.lcViews.ids.viewName).val();viewObj.lifecycles=[];e=n("input[name *='"+n.lcViews.ids.lcFiltersName+"']").filter(function(){var t=n(this).attr("checked");return t=="checked"||t==!0});n(e).each(function(){var t=n(this);t&&t.length>0&&viewObj.lifecycles.push(t.val())});viewObj.columns=[];o=n("#"+n.lcViews.ids.selectBox).val();n(o).each(function(){var n=this;n&&viewObj.columns.push(n.toString())});viewObj.filters=[];i=n("#"+n.lcViews.ids.filterBase).dynamicContent("value");for(filtKey in i)filtKey&&i[filtKey]&&(r=[],u=i[filtKey],n(u).each(function(n){r.push(u[n])}),r!=null&&viewObj.filters.push(r));s={data:viewObj};n.lcViews.methods.ajaxCall({url:t.saveOptions.url,data:n.toJSON(s),complete:function(t){var r=jQuery.parseJSON(t.responseText),i,u;r&&r.d?(i=r.d,i.success===!0?(u="?ViewId=",u+=i.message,n.lcViews.methods.getUrl(u,!0)):n.lcViews.methods.showError(i.message)):n.lcViews.methods.showError("Failure! Please try later.")}})},prepareViewColumns:function(t,i){var e=n("input[name *='"+n.lcViews.ids.lcFiltersName+"']").filter(function(){var t=n(this).attr("checked");return t=="checked"||t==!0}),u=[],r,f;n(e).each(function(){var i=n(this).val();n(t.lcData).each(function(){var n=this;if(n.iName==i)return u.push(n),!1})});r=[];n(u).each(function(t){var i=this;r=t==0?i.columns:n.lcViews.methods.interSection(r,i.columns)});f=i===!0?t.viewConfig:null;n.lcViews.methods.applySelectPlugin(r,f);n.lcViews.methods.updataFilterColumns()},addFiltersFromConfig:function(t){n(t.filters).each(function(){var t=this;if(t){var r=t.column,u=t.operand,f=t.val,e=t.isDate,i;n("#"+n.lcViews.ids.filterBase).dynamicContent("addRow",null,{beforeAdded:function(t,o){switch(o){case 0:t.find("option[value='"+r+"']").attr("selected","selected");break;case 1:var s=n("#"+i);n.lcViews.methods.updateFilterTemplate.apply(s,[!1,t]);t.find("option[value='"+u+"']").attr("selected","selected");break;case 2:e===!0&&t.datepicker({dateFormat:"M dd, yy",changeMonth:!0,changeYear:!0});t.val(f)}},afterAdded:function(n,t){t===0&&(i=n.attr("id"))}})}})},updateFilterTemplate:function(t,i){var u=this,f=n("option:selected",u),h=f.attr("formatter")?f.attr("formatter"):"text",e=u.attr("id"),r=null,o,s;i||(o=e.replace("inputelem_0","inputelem_1"),i=n("#"+o));t===!0&&(s=e.replace("inputelem_0","inputelem_2"),r=n("#"+s),r.datepicker("destroy").val(""));i.html("");switch(h){case"number":n(["Eq","Neq","Gt","Geq","Lt","Leq"]).each(function(){var t=this,r;t&&(r=n(n.lcViews.operands).filter(function(){return this.iName==t}),n(r).each(function(){var t=this;t&&i.append(n("<option><\/option>").val(t.iName).html(t.dName))}))});break;case"date":n(["Eq","Neq","Gt","Geq","Lt","Leq"]).each(function(){var t=this,r;t&&(r=n(n.lcViews.operands).filter(function(){return this.iName==t}),n(r).each(function(){var t=this;t&&i.append(n("<option><\/option>").val(t.iName).html(t.dName))}))});r&&r.datepicker({dateFormat:"M dd, yy"});break;case"text":default:n(["Eq","Neq","BeginsWith","Contains"]).each(function(){var t=this,r;t&&(r=n(n.lcViews.operands).filter(function(){return this.iName==t}),n(r).each(function(){var t=this;t&&i.append(n("<option><\/option>").val(t.iName).html(t.dName))}))})}},prepareFilterTemplate:function(){var t=[],i=n("#"+n.lcViews.ids.selectBox).html(),r=n("<select class = 'xp-Width-94' />").html(i).change(function(){var t=n(this);n.lcViews.methods.updateFilterTemplate.apply(t,[!0])});return t.push({headerText:"Select Column",element:r}),t.push({headerText:"Select operation",element:"<select class = 'xp-Width-94'><\/select>"}),t.push({headerText:"Value",element:"<input style='height:18px' class = 'xp-Width-94 xp-TxtBox '/>"}),t},prepareFilterColumns:function(){var t=n.lcViews.methods.prepareFilterTemplate();n("#"+n.lcViews.ids.filterBase).dynamicContent({template:t,actions:[{iconCSS:"ui-icon-circle-close",onClick:function(){var t=n(this);n("#"+n.lcViews.ids.filterBase).dynamicContent("deleteRow",t)}}],afLinkClk:function(t){t&&n("select:first",t).trigger("change")}})},updataFilterColumns:function(){var t=n.lcViews.methods.prepareFilterTemplate();n("#"+n.lcViews.ids.filterBase).dynamicContent("updateOptions",{template:t})},resetData:function(t){var i=n.lcViews.methods.prepareViewColumns(t);n.lcViews.methods.resetSelectedList()},resetSelectedList:function(){n("#"+n.lcViews.ids.filterBase).dynamicContent("resetData",!0)}},errorDivCss:"xp-ErrorMsg",defaults:{viewConfig:{id:-1,dName:"",lcFilter:[],columns:[],filters:[]},headerText:"Create New View",deleteEnable:!1,deleteOptions:{url:""},enableSave:!1,saveOptions:{url:""},lcData:[],events:{onHeaderCreation:function(t){var i=n(this);t.viewConfig.id>0&&(t.headerText="Modify "+t.viewConfig.dName);i.append(t.headerText)}}}};n.fn.lcViews=function(t,i){var r;if(this&&this.length!==0)return"string"==typeof t&&n.lcViews.methods[t]?(r=n.extend(this.get(0).options,n.makeArray(arguments).slice(1)[0]),n.lcViews.methods[t].apply(this,n.makeArray(r))):(r=n.extend(n.lcViews.defaults,t),n.lcViews.operands=i,this.each(function(){this.options=r;n.lcViews.methods.init.apply(this,n.makeArray(r))}))}})($);
/*
//# sourceMappingURL=xpoint.lcViews.min.js.map
*/