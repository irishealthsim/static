(function(n){var e=n.fileUpload={},f,t,u,r,i;n.fileUpload=n.fileUpload||{};n.fn.fileUpload=function(t){this.options=n.extend(n.fileUpload.defaults,t);n.fileUpload.methods.init.apply(this,n.makeArray(this.options))};f=n("#tool-upload-files-dialog");i="false";allowedFileExtensions=["2mdl","7zip","accd","accdb","accdc","accde","accdr","accdt","accdt_1033","ai","avi","bmp","cat","chm","cin","config","css","csv","dat","db","dib","disc","do","docm","doc","docx","dot","dot","dotm","dotx","dta","dvd","dwp","dwt","emf","eml","eps","est","flv","frm","fwp","gif","gin","gis","gph","hdp","hlp","hta","htt","idml","indb","indd","indl","indt","inf","ini","jfif","jpe","jpeg","jpg","jse","log","lst","master","mdb","mdl","mht","mov","mp3","mp4","mpd","mpp","mps","mpt","mpw","mpx","msg","ocx","odc","odp","ods","odt","ogv","one","onepkg","onetoc2","pdf","pmd","png","pot","potm","potx","ppa","ppam","pps","ppsd","ppsm","ppsx","ppt","pptm","pptx","prm","psd","psp","pst","ptm","ptt","pub","pub","quark","rdl","rep","rsapplication","rsc","rsd","rsds","rtf","smdl","stp","sts","stt","swf","tab","txt","tar","vcd","vcf","vdf","vdi","vdo","vgd","vgf","vmf","voc","vpa","vpd","vpm","vsc","vsd","vts","wmf","xlf","xlsm","xqx","xslb","xls","xlsx","xlt","xlst","zip","sgt","key","thm","thmx","scx"];n.fileUpload={serviceUrlRef:{uploadFiles:"/_layouts/IImpact.Web/LifecycleDocumentTemplateService.asmx/AddFile",UploadLatestFile:"/_layouts/IImpact.Web/LifeCycleDocumentsService.asmx/Checkin"},ids:{fileupload:"fileupload",linkDialog:"documentLinkDialogId",buttonAttach:"buttonAttachId",buttonCancel:"buttonCancelId"},classes:{highlight:"xp-Customhighlight",lcFolder:"xp-LCDocFolder",lcFile:"xp-LCDocFile",linkRoot:"xp-LinkRoot",customTitle:"xp-CustomTitle"},methods:{init:function(t){var i=n(this);n.fileUpload.methods.createHtml.apply(i,n.makeArray(t))},createHtml:function(f){var e=n(this),y=f.toolHeader,h=n("#"+f.formId),v=h.css("z-index"),c,o,s,a,l;e.hide();c=n("<div />");o=n("<div id='docLinkId' class='xp-FloatLeft xp-Width50 xp-Height-20' style='border: 1px solid #b9b9b9; padding:2px; overflow:hidden;' />");o.html(e.val());s=n("<div id='fileuploadPopup' style='margin-top:6px;float:left;'><a class='xpThemeButton xpPadding  ui-primarytabclr ui-corner-all' >"+f.attachfilelbl+"<\/a><\/div>");a=n("<div id='deleteLink' style='float:left;margin-top:6px; margin-left:10px;'><a class='xpThemeButton xpPadding  ui-primarytabclr ui-corner-all'>"+f.removelbl+"<\/a><\/div>");c.append(o).append(s).append(a);e.after(c);e.val()==0&&(n("#deleteLink").css("display","none"),n("#docLinkId").css("display","none"));e.val()!=0&&(n("#fileuploadPopup").css("display","none"),n("#deleteLink").css("display","block"),n("#docLinkId").css("display","block"),l=n(e.val()).text(),n.ajax({url:"/_layouts/IImpact.Web/SevernDeanery/SupportMaterialsService.asmx/UploadedFileUrl",contentType:"application/json; charset=utf-8",type:"post",dataType:"json",async:!1,responseType:"json",data:"{filename:'"+l+"',trackerId:'"+f.trackerId+"',toolName:'"+f.toolHeader+"'}",success:function(n){var t=n.d;href="<div class='docLinkOverlay' onclick='return false;'><a data-docname='"+l+"' href='"+t+"' >"+l+"<\/a><\/div>";o.html(href);e.val(href)}}),s.attr("disabled",!0).addClass("not-allowed"),n("#Linkid").attr("disabled",!0));a.click(function(){var t=o.text();s.attr("disabled",!1).removeClass("not-allowed");n.ajax({url:"/_layouts/IImpact.Web/SevernDeanery/SupportMaterialsService.asmx/removeUploadedToolFile",contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:"{fileName:'"+t+"',trackerId:'"+f.trackerId+"',folderName:'"+f.toolHeader+"'}",responseType:"json",success:function(t){var i=t.d;n("#fileuploadPopup").css("display","block");n("#deleteLink").css("display","none");n("#docLinkId").css("display","none")}});o.html("");e.val("")});s.click(function(){var l=n("<div id='"+n.fileUpload.ids.linkDialog+"' title=''/>");l.dialog("close");n.ajax({url:n.documentLinksDialog.paths.getRootFolderContents,contentType:"application/json; charset=utf-8",type:"post",dataType:"json",data:"{}",success:function(a){var y=a.d;c.append(l);l.css("z-index","999999");l.dialog({autoOpen:!1,width:400,height:150,modal:!0,position:{my:"center",at:"center",of:h},open:function(){var i=n(this).parent(),t;h.css("z-index","1");t=n("<div class='"+n.fileUpload.classes.customTitle+" xp-FontBold xp-FloatLeft'>"+f.attachfilelbl+"<\/div>");i.find(".ui-dialog-title").append(t);n("#"+n.fileUpload.ids.buttonAttach).attr("disabled",!1)},beforeclose:function(){h.css("z-index",v)},close:function(){n("div.ui-dialog").remove();n(this).dialog("destroy").dialog("widget").remove()},buttons:[{text:f.browselbl,id:"browseFile",click:function(s){var h=n("#browseFile"),c;h.replaceWith(h=h.clone(!0));c="/_layouts/IImpact.Web/SevernDeanery/SupportMaterialsService.asmx/AddFile";s.preventDefault();t=new AjaxUpload(n("#browseFile"),{action:c,autoSubmit:!1,name:"uploadFile",dataType:"json",onComplete:function(t){n.ajax({url:"/_layouts/IImpact.Web/SevernDeanery/SupportMaterialsService.asmx/UploadedFileUrl",contentType:"application/json; charset=utf-8",type:"post",dataType:"json",responseType:"json",data:"{filename:'"+t+"',trackerId:'"+f.trackerId+"',folderId:'"+r+"',toolName:'"+f.toolHeader+"'}",success:function(i){n("#deleteLink").css("display","block");n("#docLinkId").css("display","block");var r=i.d;href="<div class='docLinkOverlay' onclick='return false;'><a data-docname='"+t+"' href='"+r+"' >"+t+"<\/a><\/div>";o.html(href);e.val(href)}})},onSubmit:function(){t.setData({folderId:r,trackerId:f.trackerId});n("#fileuploadPopup").css("display","none")},onChange:function(t,e){result=n.inArray(e.toLowerCase(),allowedFileExtensions);~result?(u=t,n.ajax({url:"/_layouts/IImpact.Web/SevernDeanery/SupportMaterialsService.asmx/checkExistingFile",contentType:"application/json; charset=utf-8",type:"post",dataType:"json",responseType:"json",data:"{filename:'"+t+"', toolName:'"+f.toolHeader+"',trackerId:'"+f.trackerId+"'}",success:function(u){var f=u.d;r=f.ParentFolderId;f.Status=="true"?(i="true",n("#documentLinkDialogId").html("This file has already been added... Please add another file to attach.")):(i="false",n("#documentLinkDialogId").html(t),n("#documentLinkDialogId").addClass(n.fileUpload.classes.highlight),n("#browseFile").attr("disabled",!0).addClass("not-allowed"),n("#"+n.fileUpload.ids.buttonAttach).attr("disabled",!1).removeClass("not-allowed"))}})):n("#documentLinkDialogId").html("Oops!! Something went wrong with the Filetype. Please try other file types.")}});s.preventDefault()}},{text:f.attachlbl,id:n.fileUpload.ids.buttonAttach,click:function(){var r=n(this),f=u,e=r.val();i=="false"&&(t.submit(),s.attr("disabled",!0).addClass("not-allowed"));n(this).dialog("close");o.append("<div id='relayAjaxLoading'><div class='xp-Width xp-TextAlignCenter xp-Height100 xp-relayAjaxLoader'><img src='/_layouts/Images/XPointBase/xp-loader.gif'style='z-index:999999999;text-align:center;'/><\/div><\/div>")}},{text:f.cancellbl,id:n.fileUpload.ids.buttonCancel,click:function(){n(this).dialog("close")}}]});l.dialog("open");n("#"+n.fileUpload.ids.buttonAttach).attr("disabled",!0).addClass("not-allowed");n.fileUpload.methods.initiateAjaxFileUpload(f)}})})},initiateAjaxFileUpload:function(i){t=new AjaxUpload(n("#browseFile"),{action:"/_layouts/IImpact.Web/SevernDeanery/SupportMaterialsService.asmx/AddFile",autoSubmit:!1,name:"uploadFile",dataType:"json",onComplete:function(t){n.ajax({url:"/_layouts/IImpact.Web/SevernDeanery/SupportMaterialsService.asmx/UploadedFileUrl",contentType:"application/json; charset=utf-8",type:"post",dataType:"json",responseType:"json",data:"{filename:'"+t+"',trackerId:'"+i.trackerId+"',toolName:'"+i.toolHeader+"'}",success:function(n){var i=n.d;href="<div class='docLinkOverlay' onclick='return false;'><a data-docname='"+t+"' href='"+i+"' >"+t+"<\/a><\/div>";docLink.html(href);elem.val(href)}})}});n("#browseFile").trigger("click")}}}})(jQuery);
/*
//# sourceMappingURL=xpoint.fileUpload.min.js.map
*/