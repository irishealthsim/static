(function(n){n.fn.extend({getColProp:function(n){var r={},u=this[0],i,t;if(u.grid){for(i=u.p.colModel,t=0;t<i.length;t++)if(i[t].name==n){r=i[t];break}return r}},setColProp:function(t,i){return this.each(function(){var u,r;if(this.grid&&i)for(u=this.p.colModel,r=0;r<u.length;r++)if(u[r].name==t){n.extend(this.p.colModel[r],i);break}})},sortGrid:function(n,t){return this.each(function(){var i=this,u=-1,r,f;if(i.grid){for(n||(n=i.p.sortname),r=0;r<i.p.colModel.length;r++)if(i.p.colModel[r].index==n||i.p.colModel[r].name==n){u=r;break}u!=-1&&(f=i.p.colModel[u].sortable,typeof f!="boolean"&&(f=!0),typeof t!="boolean"&&(t=!1),f&&i.sortData("jqgh_"+n,u,t))}})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&n(this.p.pager).remove();var t=this.id;try{n("#gbox_"+t).remove()}catch(i){}}})},GridUnload:function(){return this.each(function(){var r,t,i;this.grid&&(r={id:n(this).attr("id"),cl:n(this).attr("class")},this.p.pager&&n(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom"),t=document.createElement("table"),n(t).attr({id:r.id}),t.className=r.cl,i=this.id,n(t).removeClass("ui-jqgrid-btable"),n(this.p.pager).parents("#gbox_"+i).length===1?(n(t).insertBefore("#gbox_"+i).show(),n(this.p.pager).insertBefore("#gbox_"+i)):n(t).insertBefore("#gbox_"+i).show(),n("#gbox_"+i).remove())})},updateGridRows:function(t,i,r){var u,f=!1;return this.each(function(){var e=this,s,h,o,c;if(!e.grid)return!1;i||(i="id");t&&t.length>0&&n(t).each(function(){if(o=this,h=e.rows.namedItem(o[i]),h){if(c=o[i],r===!0&&e.p.jsonReader.repeatitems===!0){e.p.jsonReader.cell&&(o=o[e.p.jsonReader.cell]);for(var t=0;t<o.length;t++)s=e.formatter(c,o[t],t,o,"edit"),e.p.treeGrid===!0&&u==e.p.ExpandColumn?n("td:eq("+t+") > span:first",h).html(s).attr("title",n.jgrid.stripHtml(s)):n("td:eq("+t+")",h).html(s).attr("title",n.jgrid.stripHtml(s));return f=!0,!0}n(e.p.colModel).each(function(t){u=r===!0?this.jsonmap||this.name:this.name;o[u]!=undefined&&(s=e.formatter(c,o[u],t,o,"edit"),e.p.treeGrid===!0&&u==e.p.ExpandColumn?n("td:eq("+t+") > span:first",h).html(s).attr("title",n.jgrid.stripHtml(s)):n("td:eq("+t+")",h).html(s).attr("title",n.jgrid.stripHtml(s)),f=!0)})}})}),f},filterGrid:function(t,i){return i=n.extend({gridModel:!1,gridNames:!1,gridToolbar:!1,filterModel:[],formtype:"horizontal",autosearch:!0,formclass:"filterform",tableclass:"filtertable",buttonclass:"filterbutton",searchButton:"Search",clearButton:"Clear",enableSearch:!1,enableClear:!1,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,url:"",marksearched:!0},i||{}),this.each(function(){var r=this,u,s,e;if(this.p=i,this.p.filterModel.length==0&&this.p.gridModel===!1){alert("No filter is set");return}if(!t){alert("No target grid is set!");return}if(this.p.gridid=t.indexOf("#")!=-1?t:"#"+t,u=n(this.p.gridid).getGridParam("colModel"),u)this.p.gridModel===!0?(s=n(this.p.gridid)[0],n.each(u,function(n){var t=[];this.search=this.search===!1?!1:!0;e=this.editrules&&this.editrules.searchhidden===!0?!0:this.hidden===!0?!1:!0;this.search===!0&&e===!0&&(t.label=r.p.gridNames===!0?s.p.colNames[n]:"",t.name=this.name,t.index=this.index||this.name,t.stype=this.edittype||"text",t.stype!="select"&&(t.stype="text"),t.defval=this.defval||"",t.surl=this.surl||"",t.sopt=this.editoptions||{},t.width=this.width,r.p.filterModel.push(t))})):n.each(r.p.filterModel,function(){for(var n=0;n<u.length;n++)if(this.name==u[n].name){this.index=u[n].index||this.name;break}this.index||(this.index=this.name)});else{alert("Could not get grid colModel");return}var f=function(){var f={},e=0,i,t=n(r.p.gridid)[0],u,s,o;t.p.searchdata={};n.isFunction(r.p.beforeSearch)&&r.p.beforeSearch();n.each(r.p.filterModel,function(){u=this.index;switch(this.stype){case"select":if(i=n("select[name="+u+"]",r).val(),i)f[u]=i,r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).addClass("dirty-cell"),e++;else{r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).removeClass("dirty-cell");try{delete t.p.postData[this.index]}catch(o){}}break;default:if(i=n("input[name="+u+"]",r).val(),i)f[u]=i,r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).addClass("dirty-cell"),e++;else{r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).removeClass("dirty-cell");try{delete t.p.postData[this.index]}catch(o){}}}});s=e>0?!0:!1;n.extend(t.p.postData,f);r.p.url&&(o=n(t).getGridParam("url"),n(t).setGridParam({url:r.p.url}));n(t).setGridParam({search:s,page:1}).trigger("reloadGrid");o&&n(t).setGridParam({url:o});n.isFunction(r.p.afterSearch)&&r.p.afterSearch()},h=function(){var f={},i,e=0,t=n(r.p.gridid)[0],u,s,o;n.isFunction(r.p.beforeClear)&&r.p.beforeClear();n.each(r.p.filterModel,function(){u=this.index;i=this.defval?this.defval:"";this.stype||this.stype=="text";switch(this.stype){case"select":var o;if(n("select[name="+u+"] option",r).each(function(t){return t==0&&(this.selected=!0),n(this).text()==i?(this.selected=!0,o=n(this).val(),!1):void 0}),o)f[u]=o,r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).addClass("dirty-cell"),e++;else{r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).removeClass("dirty-cell");try{delete t.p.postData[this.index]}catch(s){}}break;case"text":if(n("input[name="+u+"]",r).val(i),i)f[u]=i,r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).addClass("dirty-cell"),e++;else{r.p.marksearched&&n("#jqgh_"+this.name,t.grid.hDiv).removeClass("dirty-cell");try{delete t.p.postData[this.index]}catch(s){}}}});s=e>0?!0:!1;n.extend(t.p.postData,f);r.p.url&&(o=n(t).getGridParam("url"),n(t).setGridParam({url:r.p.url}));n(t).setGridParam({search:s,page:1}).trigger("reloadGrid");o&&n(t).setGridParam({url:o});n.isFunction(r.p.afterClear)&&r.p.afterClear()},l=function(){var u=document.createElement("tr"),i,s,c,e,t;r.p.formtype=="horizontal"&&n(o).append(u);n.each(r.p.filterModel,function(s){var h,l,a,w,v,c,y,p,b,k;e=document.createElement("td");n(e).append("<label for='"+this.name+"'>"+this.label+"<\/label>");t=document.createElement("td");h=this;this.stype||(this.stype="text");switch(this.stype){case"select":if(this.surl)n(t).load(this.surl,function(){h.defval&&n("select",this).val(h.defval);n("select",this).attr({name:h.index||h.name,id:"sg_"+h.name});h.sopt&&n("select",this).attr(h.sopt);r.p.gridToolbar===!0&&h.width&&n("select",this).width(h.width);r.p.autosearch===!0&&n("select",this).change(function(){return f(),!1})});else if(h.sopt.value){if(l=h.sopt.value,a=document.createElement("select"),n(a).attr({name:h.index||h.name,id:"sg_"+h.name}).attr(h.sopt),typeof l=="string")for(w=l.split(";"),y=0;y<w.length;y++)v=w[y].split(":"),c=document.createElement("option"),c.value=v[0],c.innerHTML=v[1],v[1]==h.defval&&(c.selected="selected"),a.appendChild(c);else if(typeof l=="object")for(p in l)s++,c=document.createElement("option"),c.value=p,c.innerHTML=l[p],l[p]==h.defval&&(c.selected="selected"),a.appendChild(c);r.p.gridToolbar===!0&&h.width&&n(a).width(h.width);n(t).append(a);r.p.autosearch===!0&&n(a).change(function(){return f(),!1})}break;case"text":b=this.defval?this.defval:"";k=n("<input autocomplete='off' type='text' name='"+(this.index||this.name)+"' id='sg_"+this.name+"' value='"+b+"'/>");n(t).append(k);h.sopt&&n("input",t).attr(h.sopt);r.p.gridToolbar===!0&&h.width&&(n.browser.msie?n("input",t).width(h.width-4):n("input",t).width(h.width-2));r.p.autosearch===!0&&n("input",t).keypress(function(n){var t=n.charCode?n.charCode:n.keyCode?n.keyCode:0;return t==13?(f(),!1):this})}r.p.formtype=="horizontal"?(r.p.gridToolbar===!0&&r.p.gridNames===!1?n(u).append(t):n(u).append(e).append(t),n(u).append(t)):(i=document.createElement("tr"),n(i).append(e).append(t),n(o).append(i))});t=document.createElement("td");r.p.enableSearch===!0&&(s="<input type='button' id='sButton' class='"+r.p.buttonclass+"' value='"+r.p.searchButton+"'/>",n(t).append(s),n("input#sButton",t).click(function(){return f(),!1}));r.p.enableClear===!0&&(c="<input type='button' id='cButton' class='"+r.p.buttonclass+"' value='"+r.p.clearButton+"'/>",n(t).append(c),n("input#cButton",t).click(function(){return h(),!1}));(r.p.enableClear===!0||r.p.enableSearch===!0)&&(r.p.formtype=="horizontal"?n(u).append(t):(i=document.createElement("tr"),n(i).append("<td>&nbsp;<\/td>").append(t),n(o).append(i)))},c=n("<form name='SearchForm' style=display:inline;' class='"+this.p.formclass+"'><\/form>"),o=n("<table class='"+this.p.tableclass+"' cellspacing='0' cellpading='0' border='0'><tbody><\/tbody><\/table>");n(c).append(o);l();n(this).append(c);this.triggerSearch=function(){f()};this.clearSearch=function(){h()}})},filterToolbar:function(t){return t=n.extend({autosearch:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:""},t||{}),this.each(function(){function o(t,i){var r=n(t);r[0]!=null&&jQuery.each(i,function(){this.data!=null?r.bind(this.type,this.data,this.fn):r.bind(this.type,this.fn)})}var i=this,f=function(){var f={},e=0,u,r,s,o;i.p.searchdata={};n.isFunction(t.beforeSearch)&&t.beforeSearch();n.each(i.p.colModel,function(){r=this.index||this.name;switch(this.stype){case"select":if(u=n("select[name='"+r+"']",i.grid.hDiv).val(),u)f[r]=u,e++;else try{delete i.p.postData[r]}catch(t){}break;case"text":if(u=n("input[name='"+r+"']",i.grid.hDiv).val(),u)f[r]=u,e++;else try{delete i.p.postData[r]}catch(t){}}});s=e>0?!0:!1;n.extend(i.p.postData,f);i.p.searchurl&&(o=i.p.url,n(i).setGridParam({url:i.p.searchurl}));n(i).setGridParam({search:s,page:1}).trigger("reloadGrid");o&&n(i).setGridParam({url:o});n.isFunction(t.afterSearch)&&t.afterSearch()},h=function(){var f={},u,e=0,r,s,o;n.isFunction(t.beforeClear)&&t.beforeClear();n.each(i.p.colModel,function(){u=this.searchoptions&&this.searchoptions.defaultValue?this.searchoptions.defaultValue:"";r=this.index||this.name;switch(this.stype){case"select":var t;if(n("select[name="+r+"] option",i.grid.hDiv).each(function(i){return i==0&&(this.selected=!0),n(this).text()==u?(this.selected=!0,t=n(this).val(),!1):void 0}),t)f[r]=t,e++;else try{delete i.p.postData[r]}catch(o){}break;case"text":if(n("input[name="+r+"]",i.grid.hDiv).val(u),u)f[r]=u,e++;else try{delete i.p.postData[r]}catch(o){}}});s=e>0?!0:!1;n.extend(i.p.postData,f);i.p.searchurl&&(o=i.p.url,n(i).setGridParam({url:i.p.searchurl}));n(i).setGridParam({search:s,page:1}).trigger("reloadGrid");o&&n(i).setGridParam({url:o});n.isFunction(t.afterClear)&&t.afterClear()},c=function(){var t=n("tr.ui-search-toolbar",i.grid.hDiv);t.css("display")=="none"?t.show():t.hide()},s=n("<tr class='ui-search-toolbar' role='rowheader'><\/tr>"),e,u,r;n.each(i.p.colModel,function(i){var h=this,a,c,y,p,l,v,w,b,k;e=n("<th role='columnheader' class='ui-state-default ui-th-column'><\/th>");u=n("<div style='width:100%;position:relative;'><\/div>");this.hidden===!0&&n(e).css("display","none");this.search=this.search===!1?!1:!0;typeof this.stype=="undefined"&&(this.stype="text");r=n.extend({},this.searchoptions||{});switch(this.stype){case"select":if(this.surl)n(u).load(this.surl,{_nsd:(new Date).getTime()},function(){r.defaultValue&&n("select",this).val(r.defaultValue);n("select",this).attr({name:h.index||h.name,id:"gs_"+h.name});r.attr&&n("select",this).attr(r.attr);n("select",this).css({width:"100%"});r.dataInit!=null&&r.dataInit(n("select",this)[0]);r.dataEvents!=null&&o(n("select",this)[0],r.dataEvents);t.autosearch===!0&&n("select",this).change(function(){return f(),!1})});else if(h.editoptions&&h.editoptions.value){if(a=h.editoptions.value,c=document.createElement("select"),this.search||(c.disabled=!0),c.style.width="100%",n(c).attr({name:h.index||h.name,id:"gs_"+h.name}),typeof a=="string")for(y=a.split(";"),v=0;v<y.length;v++)p=y[v].split(":"),l=document.createElement("option"),l.value=p[0],l.innerHTML=p[1],c.appendChild(l);else if(typeof a=="object")for(w in a)i++,l=document.createElement("option"),l.value=w,l.innerHTML=a[w],c.appendChild(l);r.defaultValue&&n(c).val(r.defaultValue);r.attr&&n(c).attr(r.attr);r.dataInit!=null&&r.dataInit(c);r.dataEvents!=null&&o(c,r.dataEvents);n(u).append(c);t.autosearch===!0&&n(c).change(function(){return f(),!1})}break;case"text":b=r.defaultValue?r.defaultValue:"";this.search?(k=n("<input autocomplete='off' type='text' style='width:95%;padding:0px;' name='"+(h.index||h.name)+"' id='gs_"+h.name+"' value='"+b+"'/>"),n(u).append(k)):n(u).append("<input autocomplete='off' type='text' disabled='disabled' style='background-color:gray;width:95%;padding:0px;' name='"+(h.index||h.name)+"' id='gs_"+h.name+"' value='"+b+"'/>");r.attr&&n("input",u).attr(r.attr);r.dataInit!=null&&r.dataInit(n("input",u)[0]);r.dataEvents!=null&&o(n("input",u)[0],r.dataEvents);t.autosearch===!0&&n("input",u).keypress(function(n){var t=n.charCode?n.charCode:n.keyCode?n.keyCode:0;return t==13?(f(),!1):this})}n(e).append(u);n(s).append(e)});n("table thead",i.grid.hDiv).append(s);this.triggerToolbar=function(){f()};this.clearToolbar=function(){h()};this.toggleToolbar=function(){c()}})}})})(jQuery);
/*
//# sourceMappingURL=grid.custom.min.js.map
*/